{% extends "base.html" %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —É—á–µ–Ω–∏–∫–∞{% endblock %}

{% block extra_css %}
<style>
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –õ–ö–£ */
    .cabinet-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    /* –í–ö–õ–ê–î–ö–ò */
    .tabs-container {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 8px;
        display: flex;
        gap: 8px;
        margin-bottom: 30px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .tab-button {
        padding: 15px 30px;
        background: transparent;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        color: rgba(217, 246, 244, 0.7);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        min-width: 140px;
    }

    .tab-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, #5ED9D7, #4ECDC4);
        opacity: 0;
        transition: all 0.3s ease;
        border-radius: 15px;
    }

    .tab-button.active::before {
        opacity: 1;
    }

    .tab-button.active {
        color: white;
        box-shadow: 0 4px 15px rgba(94, 217, 215, 0.3);
        transform: translateY(-2px);
    }

    .tab-button span {
        position: relative;
        z-index: 1;
    }

    .tab-button:hover {
        color: #5ED9D7;
        transform: translateY(-1px);
    }

    /* –°–û–î–ï–†–ñ–ò–ú–û–ï –í–ö–õ–ê–î–û–ö */
    .tab-content {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
        display: block;
    }

    /* –ö–ê–†–¢–û–ß–ö–ò */
    .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }

    .action-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 25px;
        transition: all 0.3s ease;
        cursor: pointer;
        text-align: center;
    }

    .action-card:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .action-card h3 {
        color: #5ED9D7;
        font-size: 1.4rem;
        margin-bottom: 15px;
    }

    .action-card p {
        margin-bottom: 20px;
        opacity: 0.8;
    }

    /* –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ö–ù–û–ü–ö–ò */
    .btn-zoom {
        background: linear-gradient(45deg, #4285F4, #34A853);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        margin: 5px;
        box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
    }

    .btn-zoom:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(66, 133, 244, 0.5);
    }

    .btn-board {
        background: linear-gradient(45deg, #FF6B35, #F7931E);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        margin: 5px;
        box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    .btn-board:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
    }

    /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .stat-card {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: translateY(-3px);
    }

    .stat-value {
        font-size: 2rem;
        font-weight: bold;
        color: #5ED9D7;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 0.9rem;
        opacity: 0.8;
    }

    /* –¢–ê–ë–õ–ò–¶–´ */
    .lessons-table {
        width: 100%;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        overflow: hidden;
        margin: 20px 0;
    }

    .lessons-table th,
    .lessons-table td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .lessons-table th {
        background: rgba(94, 217, 215, 0.2);
        color: #5ED9D7;
        font-weight: bold;
    }

    .lessons-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
    }

    /* –†–ï–ô–¢–ò–ù–ì */
    .rating-list {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        overflow: hidden;
        margin: 20px 0;
    }

    .rating-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
    }

    .rating-item:hover {
        background: rgba(255, 255, 255, 0.05);
        transform: translateX(5px);
    }

    .rating-item.current-user {
        background: rgba(94, 217, 215, 0.2);
        border: 1px solid rgba(94, 217, 215, 0.4);
        box-shadow: 0 0 15px rgba(94, 217, 215, 0.3);
        border-radius: 10px;
        margin: 2px;
    }

    .rank {
        font-size: 1.5rem;
        font-weight: bold;
        color: #5ED9D7;
        min-width: 50px;
    }

    .player-name {
        flex: 1;
        margin-left: 20px;
    }

    .score {
        font-size: 1.2rem;
        color: #96CEB4;
        font-weight: bold;
    }

    /* –ö–ê–õ–ï–ù–î–ê–†–¨ –í–ò–î–ñ–ï–¢ */
    .calendar-widget {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        min-height: 400px;
    }

    .calendar-widget iframe {
        width: 100%;
        height: 600px;
        border: none;
        border-radius: 10px;
    }

    /* –ò–ì–†–û–í–û–ô –í–ò–î–ñ–ï–¢ */
    .game-widget {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        min-height: 300px;
        text-align: center;
    }

    .game-placeholder {
        padding: 60px 20px;
        color: rgba(217, 246, 244, 0.7);
    }

    .game-placeholder h3 {
        color: #5ED9D7;
        margin-bottom: 15px;
    }

    /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
    @media (max-width: 768px) {
        .tabs-container {
            flex-direction: column;
            gap: 5px;
        }

        .tab-button {
            min-width: auto;
            padding: 12px 20px;
        }

        .card-grid {
            grid-template-columns: 1fr;
        }

        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .rating-item {
            flex-direction: column;
            text-align: center;
            gap: 10px;
        }

        .player-name {
            margin-left: 0;
        }
    }

    @media (max-width: 480px) {
        .stats-grid {
            grid-template-columns: 1fr;
        }

        .cabinet-container {
            padding: 10px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="cabinet-container">
    <!-- –ó–ê–ì–û–õ–û–í–û–ö –ö–ê–ë–ò–ù–ï–¢–ê -->
    <div style="text-align: center; margin-bottom: 40px;">
        <h1 style="color: #5ED9D7; font-size: 3rem; margin-bottom: 10px; text-shadow: 0 0 20px rgba(94, 217, 215, 0.5);">
            –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —É—á–µ–Ω–∏–∫–∞
        </h1>
        <p style="font-size: 1.3rem; opacity: 0.8; margin-bottom: 20px;">
            –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ current_user.name }}!
        </p>
    </div>

    <!-- –í–ö–õ–ê–î–ö–ò -->
    <div class="tabs-container">
        <button class="tab-button active" onclick="showTab('main')">
            <span>üè† –ì–ª–∞–≤–Ω–∞—è</span>
        </button>
        <button class="tab-button" onclick="showTab('performance')">
            <span>üìä –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</span>
        </button>
        <button class="tab-button" onclick="showTab('rating')">
            <span>üèÜ –†–µ–π—Ç–∏–Ω–≥</span>
        </button>
    </div>

    <!-- –í–ö–õ–ê–î–ö–ê: –ì–õ–ê–í–ù–ê–Ø -->
    <div id="tab-main" class="tab-content active">
        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="card-grid">
            <div class="action-card">
                <h3>üéÆ –ò–≥—Ä–∞</h3>
                <p>–†–µ—à–∞–π –∑–∞–¥–∞—á–∏ –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –±–∞–ª–ª—ã!</p>
                <button class="btn btn-game" onclick="toggleGameWidget()">
                    –ò–≥—Ä–∞—Ç—å —Å–µ–π—á–∞—Å
                </button>
            </div>

            <div class="action-card">
                <h3>üíª Zoom —É—Ä–æ–∫</h3>
                <p>–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏</p>
                <a href="#" class="btn-zoom">–í–æ–π—Ç–∏ –≤ Zoom</a>
            </div>

            <div class="action-card">
                <h3>üìã –î–æ—Å–∫–∞</h3>
                <p>–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–æ—Å–∫—É</p>
                <a href="#" class="btn-board">–û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å–∫—É</a>
            </div>

            <div class="action-card">
                <h3>üé• –¢–µ–æ—Ä–∏—è</h3>
                <p>–í–∏–¥–µ–æ-—É—Ä–æ–∫–∏ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Ç–µ–º</p>
                <button class="btn btn-primary" onclick="alert('üé• –†–∞–∑–¥–µ–ª —Ç–µ–æ—Ä–∏–∏ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤!')">
                    –°–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–æ—Ä–∏—é
                </button>
            </div>

            <div class="action-card">
                <h3>üìö –ú–∞—Ç–µ—Ä–∏–∞–ª—ã</h3>
                <p>–§–æ—Ä–º—É–ª—ã, —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏</p>
                <button class="btn btn-primary" onclick="alert('üìö –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–∫–æ—Ä–æ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã!')">
                    –°–∫–∞—á–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã
                </button>
            </div>

            <div class="action-card">
                <h3>üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Ä–æ–∫</h3>
                <p>–í–Ω–µ–ø–ª–∞–Ω–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</p>
                <button class="btn btn-secondary" onclick="alert('üìÖ –ó–∞–ø–∏—Å—å –Ω–∞ —É—Ä–æ–∫–∏ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!')">
                    –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                </button>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π –≤–∏–¥–∂–µ—Ç (—Å–∫—Ä—ã—Ç—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="game-widget" class="game-widget" style="display: none;">
            <div class="game-placeholder">
                <h3>üéÆ –ò–≥—Ä–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
                <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤–∏–¥–∂–µ—Ç —Å –∏–≥—Ä–æ–≤—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏</p>
                <p style="font-size: 0.9rem; opacity: 0.6;">–ü–æ–∫–∞ —á—Ç–æ —ç—Ç–æ –∑–∞–≥–ª—É—à–∫–∞. –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏!</p>
                <button class="btn btn-secondary" onclick="toggleGameWidget()">–°–∫—Ä—ã—Ç—å</button>
            </div>
        </div>

        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
        <div class="calendar-widget">
            <h2 style="color: #5ED9D7; text-align: center; margin-bottom: 20px;">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π</h2>
            <iframe src="/–≤–∏–¥–∂–µ—Ç/{{ current_user.name }}" 
                    style="width: 100%; height: 600px; border: none; border-radius: 10px;">
            </iframe>
        </div>
    </div>

    <!-- –í–ö–õ–ê–î–ö–ê: –£–°–ü–ï–í–ê–ï–ú–û–°–¢–¨ -->
    <div id="tab-performance" class="tab-content">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">{{ stats.total_lessons or 12 }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ —É—Ä–æ–∫–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.average_score or 4.5 }}</div>
                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.attendance_rate or 95 }}%</div>
                <div class="stat-label">–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">
                    {% if stats.progress_trend == 'improving' %}üìà
                    {% elif stats.progress_trend == 'declining' %}üìâ
                    {% else %}‚û°Ô∏è{% endif %}
                </div>
                <div class="stat-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ —É—Ä–æ–∫–æ–≤ -->
        <h2 style="color: #5ED9D7; margin: 30px 0 20px 0;">üìö –ò—Å—Ç–æ—Ä–∏—è —É—Ä–æ–∫–æ–≤</h2>
        <table class="lessons-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–¢–µ–º–∞ —É—Ä–æ–∫–∞</th>
                    <th>–û—Ü–µ–Ω–∫–∞ –∑–∞ –ø—Ä–æ–±–Ω–∏–∫</th>
                    <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                </tr>
            </thead>
            <tbody>
                {% if recent_lessons %}
                    {% for lesson in recent_lessons %}
                    <tr>
                        <td>{{ lesson.date.strftime('%d.%m.%Y') if lesson.date else '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>{{ lesson.subject or '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>
                            {% if lesson.test_score %}
                                <span style="color: #96CEB4; font-weight: bold;">{{ lesson.test_score }}/32</span>
                            {% else %}
                                <span style="opacity: 0.6;">‚Äî</span>
                            {% endif %}
                        </td>
                        <td>{{ lesson.notes or '–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤' }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td>25.11.2024</td>
                        <td>–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è</td>
                        <td><span style="color: #96CEB4; font-weight: bold;">18/32</span></td>
                        <td>–•–æ—Ä–æ—à–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏ —Ç–µ–º—É, –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–æ–º</td>
                    </tr>
                    <tr>
                        <td>22.11.2024</td>
                        <td>–°–∏—Å—Ç–µ–º—ã —É—Ä–∞–≤–Ω–µ–Ω–∏–π</td>
                        <td><span style="color: #96CEB4; font-weight: bold;">22/32</span></td>
                        <td>–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å! –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–µ—à–µ–Ω–∏—è –æ—Å–≤–æ–µ–Ω—ã</td>
                    </tr>
                    <tr>
                        <td>18.11.2024</td>
                        <td>–§—É–Ω–∫—Ü–∏–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∏</td>
                        <td><span style="opacity: 0.6;">‚Äî</span></td>
                        <td>–ò–∑—É—á–∏–ª–∏ —Ç–µ–æ—Ä–∏—é, –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ - –ø—Ä–∞–∫—Ç–∏–∫–∞</td>
                    </tr>
                    <tr>
                        <td>15.11.2024</td>
                        <td>–ü—Ä–æ–±–Ω—ã–π –û–ì–≠</td>
                        <td><span style="color: #96CEB4; font-weight: bold;">25/32</span></td>
                        <td>–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –û–ì–≠ - 85%</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <!-- –í–ö–õ–ê–î–ö–ê: –†–ï–ô–¢–ò–ù–ì -->
    <div id="tab-rating" class="tab-content">
        <h2 style="color: #5ED9D7; text-align: center; margin-bottom: 30px;">üèÜ –†–µ–π—Ç–∏–Ω–≥ —É—á–µ–Ω–∏–∫–æ–≤</h2>
        
        <div class="rating-list">
            {% if rating_list %}
                {% for player in rating_list %}
                <div class="rating-item{% if player.is_current %} current-user{% endif %}">
                    <div class="rank">{{ player.rank }}</div>
                    <div class="player-name">
                        <strong>{{ player.name }}</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">{{ player.class_level }} –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">{{ player.score }} üåü</div>
                </div>
                {% endfor %}
            {% else %}
                <!-- –ó–∞–≥–ª—É—à–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
                <div class="rating-item">
                    <div class="rank">1</div>
                    <div class="player-name">
                        <strong>–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">11 –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">2850 üåü</div>
                </div>
                <div class="rating-item current-user">
                    <div class="rank">2</div>
                    <div class="player-name">
                        <strong>{{ current_user.name or '–ò–≤–∞–Ω –°–º–∏—Ä–Ω–æ–≤' }}</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">9 –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">2640 üåü</div>
                </div>
                <div class="rating-item">
                    <div class="rank">3</div>
                    <div class="player-name">
                        <strong>–ê–Ω–Ω–∞ –ö–æ–∑–ª–æ–≤–∞</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">10 –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">2420 üåü</div>
                </div>
                <div class="rating-item">
                    <div class="rank">4</div>
                    <div class="player-name">
                        <strong>–î–º–∏—Ç—Ä–∏–π –í–æ–ª–∫–æ–≤</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">9 –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">2180 üåü</div>
                </div>
                <div class="rating-item">
                    <div class="rank">5</div>
                    <div class="player-name">
                        <strong>–°–æ—Ñ–∏—è –õ–µ–±–µ–¥–µ–≤–∞</strong>
                        <div style="font-size: 0.9rem; opacity: 0.7;">11 –∫–ª–∞—Å—Å</div>
                    </div>
                    <div class="score">1950 üåü</div>
                </div>
            {% endif %}
        </div>

        <div style="text-align: center; margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 15px;">
            <p style="opacity: 0.8;">
                üéØ <strong>–¢–≤–æ—è –ø–æ–∑–∏—Ü–∏—è:</strong> {{ current_rank or '2' }} –º–µ—Å—Ç–æ<br>
                üí´ <strong>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è:</strong> {{ points_to_next or '210' }} –±–∞–ª–ª–æ–≤
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
    function showTab(tabName) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
        const contents = document.querySelectorAll('.tab-content');
        contents.forEach(content => {
            content.classList.remove('active');
        });

        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –∫–Ω–æ–ø–æ–∫
        const buttons = document.querySelectorAll('.tab-button');
        buttons.forEach(button => {
            button.classList.remove('active');
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        document.getElementById('tab-' + tabName).classList.add('active');

        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É
        event.target.classList.add('active');
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –≤–∏–¥–∂–µ—Ç–∞
    function toggleGameWidget() {
        const gameWidget = document.getElementById('game-widget');
        if (gameWidget.style.display === 'none') {
            gameWidget.style.display = 'block';
            gameWidget.scrollIntoView({ behavior: 'smooth' });
        } else {
            gameWidget.style.display = 'none';
        }
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
    setInterval(function() {
        const iframe = document.querySelector('.calendar-widget iframe');
        if (iframe && iframe.contentWindow) {
            try {
                iframe.contentWindow.location.reload();
            } catch (e) {
                // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ cross-origin
            }
        }
    }, 300000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
</script>
{% endblock %}